<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Copy corrections is based on copyrighter. One copy database for each Greengene taxon at each level is provided by the tool. We will use that database for correcting our Greengene taxonomy abundance and OTU abundance. &mdash; Microbial Ecology Protocols 0.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Microbial Ecology Protocols 0.2 documentation" href="../index.html" />


<style type="text/css">
<!-- github-based editing disabled; set github_base_account
     and github_project -->
#editor-trap.toggled {
  display: none;
}
</style>



<!-- Google Analytics JS is disabled; set google_analytics_id -->


  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
  <div class="section" id="copy-corrections-is-based-on-copyrighter-one-copy-database-for-each-greengene-taxon-at-each-level-is-provided-by-the-tool-we-will-use-that-database-for-correcting-our-greengene-taxonomy-abundance-and-otu-abundance">
<h1>Copy corrections is based on <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/24708850">copyrighter</a>. One copy database for each Greengene taxon at each level is provided by the tool. We will use that database for correcting our Greengene taxonomy abundance and OTU abundance.<a class="headerlink" href="#copy-corrections-is-based-on-copyrighter-one-copy-database-for-each-greengene-taxon-at-each-level-is-provided-by-the-tool-we-will-use-that-database-for-correcting-our-greengene-taxonomy-abundance-and-otu-abundance" title="Permalink to this headline">Â¶</a></h1>
<p>Set up a directory:</p>
<div class="highlight-python"><div class="highlight"><pre>cd /usr/local/notebooks
### set up directory
!mkdir -p ./workdir/copy_correction
</pre></div>
</div>
<p>Set up parameters:</p>
<div class="highlight-python"><div class="highlight"><pre>Prefix=&#39;SS&#39;    # name for the analysis run
Script_dir=&#39;./SSUsearch/scripts&#39;
Wkdir=&#39;./workdir&#39;
Design=&#39;./data/test/SS.design&#39;
Otu_dist_cutoff=&#39;0.05&#39;
Copy_db=&#39;./data/SSUsearch_db/Copy_db.copyrighter.txt&#39;

Script_dir=$(readlink -f $Script_dir)
Wkdir=$(readlink -f $Wkdir)
Design=$(readlink -f $Design)
Copy_db=$(readlink -f $Copy_db)
</pre></div>
</div>
<p>Go to the directory:</p>
<div class="highlight-python"><div class="highlight"><pre>cd ./workdir/copy_correction
</pre></div>
</div>
<p>Get input files from clustering directory:</p>
<div class="highlight-python"><div class="highlight"><pre>ln -sf $Wkdir/clust/$Prefix.biom
ln -sf $Wkdir/clust/$Prefix.list
</pre></div>
</div>
<p>Get Greengene taxonomy:</p>
<div class="highlight-python"><div class="highlight"><pre>cat $Wkdir/*.ssu.out/*.gg.taxonomy &gt; $Prefix.taxonomy
mothur &quot;#classify.otu(list=$Prefix.list, taxonomy=$Prefix.taxonomy, label=$Otu_dist_cutoff)&quot;
mv SS.0.03.cons.taxonomy SS.cons.taxonomy
mv SS.0.03.cons.tax.summary SS.cons.tax.summary
</pre></div>
</div>
<p>Get original OTU table:</p>
<div class="highlight-python"><div class="highlight"><pre>mothur &quot;#make.shared(biom=$Prefix.biom)&quot;
</pre></div>
</div>
<p>Do copy correction and even sampling:</p>
<div class="highlight-python"><div class="highlight"><pre>python $Script_dir/copyrighter-otutable.py $Copy_db $Prefix.cons.taxonomy $Prefix.shared $Prefix.cc.shared
mv $Prefix.cc.shared $Prefix.shared
mothur &quot;#make.biom(shared=$Prefix.shared, constaxonomy=$Prefix.cons.taxonomy);&quot;
mv $Prefix.userLabel.biom $Prefix.biom
rm -f mothur.*.logfile
</pre></div>
</div>
<p><strong>SS.biom</strong> can be further used for diversity analysis, important but not focus of this tutorial (details see <a class="reference external" href="http://www.mothur.org/wiki/454_SOP">mothur wiki</a>):</p>
<div class="highlight-python"><div class="highlight"><pre>mothur &quot;#make.shared(biom=$Prefix.biom); sub.sample(shared=$Prefix.shared); summary.single(calc=nseqs-coverage-sobs-chao-shannon-invsimpson); dist.shared(calc=braycurtis); pcoa(phylip=$Prefix.userLabel.subsample.braycurtis.userLabel.lt.dist); nmds(phylip=$Prefix.userLabel.subsample.braycurtis.userLabel.lt.dist); amova(phylip=$Prefix.userLabel.subsample.braycurtis.userLabel.lt.dist, design=$Design); tree.shared(calc=braycurtis); unifrac.weighted(tree=$Prefix.userLabel.subsample.braycurtis.userLabel.tre, group=$Design, random=T)&quot;
rm -f mothur.*.logfile;
rm -f *.rabund
</pre></div>
</div>
</div>




<!-- disqus commenting disabled; set disqus_shortname -->

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/SSUsearch/copy-correction.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer">
      &copy;2015, Jiarong Guo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="../_sources/SSUsearch/copy-correction.txt"
          rel="nofollow">Page source</a>
    </div>

    

    




<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', ]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


  </body>
</html>